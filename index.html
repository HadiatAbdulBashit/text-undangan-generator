<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Generator Pesan Undangan</title>
    <style>
      * {
        box-sizing: border-box;
      }
      body {
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        margin: 24px;
        line-height: 1.35;
      }
      h1 {
        margin: 0 0 12px;
        font-size: 20px;
      }
      .grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 12px;
        max-width: 820px;
      }
      .row {
        display: grid;
        gap: 6px;
      }
      .labelRow {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
      }
      label {
        font-weight: 600;
        font-size: 13px;
      }
      .toggle {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        font-size: 12px;
        font-weight: 600;
        user-select: none;
        white-space: nowrap;
      }
      input,
      textarea,
      select {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid #cfd4dc;
        border-radius: 8px;
        font-size: 14px;
      }
      input:disabled {
        background: #f3f4f6;
        color: #6b7280;
      }
      textarea {
        min-height: 220px;
        resize: vertical;
        white-space: pre-wrap;
      }
      .hint {
        font-size: 12px;
        color: #5b6472;
      }
      .btns {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 6px;
      }
      button {
        padding: 10px 12px;
        border: 1px solid #cfd4dc;
        border-radius: 8px;
        background: #fff;
        cursor: pointer;
        font-weight: 600;
      }
      button.primary {
        background: #111827;
        color: #fff;
        border-color: #111827;
      }
      button.wa {
        background: #25d366;
        color: #fff;
        border-color: #25d366;
      }
      button.wa:hover {
        filter: brightness(0.95);
      }
      .two {
        display: grid;
        grid-template-columns: 1fr;
        gap: 12px;
      }
      @media (min-width: 860px) {
        .two {
          grid-template-columns: 1fr 1fr;
          align-items: start;
        }
      }
      .card {
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        padding: 14px;
      }
      .mono {
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      }
    </style>
  </head>

  <body>
    <h1>Generator Pesan Undangan</h1>

    <div class="two">
      <div class="card">
        <div class="grid">
          <!-- Nama Tamu (tanpa checkbox) -->
          <div class="row">
            <label for="namaTamu">Nama Tamu (untuk parameter <span class="mono">to</span>)</label>
            <input id="namaTamu" type="text" placeholder="Contoh: Budi Santoso" />
          </div>

          <!-- Nama Acara -->
          <div class="row">
            <div class="labelRow">
              <label for="namaAcara">Nama Acara</label>
              <label class="toggle">
                <input type="checkbox" id="en_namaAcara" />
                Enable edit
              </label>
            </div>
            <!-- Anda bisa isi default value di sini nanti -->
            <input id="namaAcara" type="text" value="NGUNDUH MANTU" disabled />
          </div>

          <!-- Hari/Tanggal (date) -->
          <div class="row">
            <div class="labelRow">
              <label for="hariTanggal">Hari/Tanggal</label>
              <label class="toggle">
                <input type="checkbox" id="en_hariTanggal" />
                Enable edit
              </label>
            </div>
            <input id="hariTanggal" type="date" disabled value="2025-12-31" />
            <div class="hint">
              Di pesan akan tampil format panjang Indonesia (contoh: <span class="mono">Sabtu, 20 Januari 2026</span>).
            </div>
          </div>

          <!-- Waktu (time) -->
          <div class="row">
            <div class="labelRow">
              <label for="waktu">Waktu</label>
              <label class="toggle">
                <input type="checkbox" id="en_waktu" />
                Enable edit
              </label>
            </div>
            <input id="waktu" type="time" disabled value="08:00" />
            <div class="hint">Akan tampil sebagai: <span class="mono">19.00 WIB s/d selesai</span></div>
          </div>

          <!-- Domain -->
          <div class="row">
            <div class="labelRow">
              <label for="domain">Domain dasar (tanpa slash akhir)</label>
              <label class="toggle">
                <input type="checkbox" id="en_domain" />
                Enable edit
              </label>
            </div>
            <input id="domain" type="text" value="https://ngunduh-mantu-inti-asep.vercel.app" disabled />
            <div class="hint">Contoh: <span class="mono">https://domain.com</span></div>
          </div>

          <!-- Penutup -->
          <div class="row">
            <div class="labelRow">
              <label for="penutup">Nama Pengundang / Keluarga / Panitia</label>
              <label class="toggle">
                <input type="checkbox" id="en_penutup" />
                Enable edit
              </label>
            </div>
            <input id="penutup" type="text" value="Inti & Asep" disabled />
          </div>

          <div class="btns">
            <button class="primary" id="btnGenerate">Generate Pesan</button>
            <button id="btnCopy">Copy Pesan</button>
            <button class="wa" id="btnWhatsApp">Share WhatsApp</button>
          </div>

          <div class="row">
            <label>Preview URL Undangan</label>
            <input id="previewUrl" class="mono" type="text" readonly />
            <div class="hint">URL: <span class="mono">domain.com?to=Nama%20Tamu</span></div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="row">
          <label for="output">Pesan Hasil</label>
          <textarea id="output" readonly></textarea>
        </div>
      </div>
    </div>

    <script>
      const el = (id) => document.getElementById(id);

      function normalizeDomain(d) {
        return (d || "").trim().replace(/\/+$/, "");
      }

      function formatTanggalLongID(dateValue) {
        // dateValue: "YYYY-MM-DD"
        if (!dateValue) return "[isi]";
        const [y, m, d] = dateValue.split("-").map(Number);
        // set jam 12 untuk menghindari efek pergeseran timezone tertentu
        const dt = new Date(y, m - 1, d, 12, 0, 0);
        return new Intl.DateTimeFormat("id-ID", {
          weekday: "long",
          year: "numeric",
          month: "long",
          day: "numeric",
        }).format(dt);
      }

      function formatWaktu(waktuValue) {
        // waktuValue: "HH:MM"
        if (!waktuValue) return "[isi]";
        const [h, m] = waktuValue.split(":");
        return `${h}.${m} WIB s/d selesai`;
      }

      function buildInviteUrl() {
        const domain = normalizeDomain(el("domain").value);
        const namaTamu = (el("namaTamu").value || "").trim();

        if (!domain) return "";

        const toParam = encodeURIComponent(namaTamu);
        // domain.com?to=nama
        return `${domain}?to=${toParam}`;
      }

      function generateMessage() {
        const namaTamu = (el("namaTamu").value || "Bapak/Ibu/Saudara/i").trim();
        const namaAcara = (el("namaAcara").value || "[Nama Acara]").trim();
        const hariTanggal = formatTanggalLongID(el("hariTanggal").value);
        const waktu = formatWaktu(el("waktu").value);
        const penutup = (el("penutup").value || "[Nama Pengundang / Keluarga / Panitia]").trim();

        const url = buildInviteUrl();
        el("previewUrl").value = url;

        const linkLine = url ? `ðŸ”— ${url}` : `ðŸ”— [Link Undangan Online]`;

        const msg = `Yth. ${namaTamu}
Di Tempat

Dengan segala kerendahan hati, kami mengundang ${namaTamu} untuk menghadiri acara ${namaAcara} yang akan dilaksanakan pada:

ðŸ“… Hari/Tanggal : ${hariTanggal}
â° Waktu : ${waktu}

Merupakan suatu kehormatan dan kebahagiaan bagi kami apabila ${namaTamu} berkenan hadir dan memberikan doa restu.

Untuk detail acara, silakan klik tautan undangan berikut:
${linkLine}

Atas perhatian dan kehadirannya, kami ucapkan terima kasih.

Hormat kami,
${penutup}`;

        el("output").value = msg;
        return msg;
      }

      async function copyMessage() {
        const text = el("output").value || generateMessage();
        try {
          await navigator.clipboard.writeText(text);
          alert("Pesan berhasil dicopy.");
        } catch (e) {
          el("output").focus();
          el("output").select();
          document.execCommand("copy");
          alert("Pesan berhasil dicopy (fallback).");
        }
      }

      function shareWhatsApp() {
        const text = el("output").value || generateMessage();
        const waUrl = "https://wa.me/?text=" + encodeURIComponent(text);
        window.open(waUrl, "_blank", "noopener,noreferrer");
      }

      // Enable/disable handler
      function bindToggle(toggleId, inputId) {
        const t = el(toggleId);
        const inp = el(inputId);

        const apply = () => {
          inp.disabled = !t.checked;
        };

        t.addEventListener("change", () => {
          apply();
          generateMessage();
        });

        apply();
      }

      // Bind toggles (kecuali namaTamu)
      bindToggle("en_namaAcara", "namaAcara");
      bindToggle("en_hariTanggal", "hariTanggal");
      bindToggle("en_waktu", "waktu");
      bindToggle("en_domain", "domain");
      bindToggle("en_penutup", "penutup");

      // Events
      el("btnGenerate").addEventListener("click", generateMessage);
      el("btnCopy").addEventListener("click", copyMessage);
      el("btnWhatsApp").addEventListener("click", shareWhatsApp);

      // Auto update on input changes
      ["namaTamu", "namaAcara", "hariTanggal", "waktu", "domain", "penutup"].forEach((id) => {
        el(id).addEventListener("input", () => {
          generateMessage();
        });
      });

      // Initial
      generateMessage();
    </script>
  </body>
</html>
